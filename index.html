<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.0.0/docx.js"></script>
</head>
<body>
    <h1>Input Data to Generate DOCX</h1>
    <form id="docForm">
        <label for="coordinates">Coordinates:</label>
        <input type="text" id="coordinates" name="coordinates" required><br><br>

        <label for="description">Description:</label>
        <textarea id="description" name="description" required></textarea><br><br>

        <label for="imageUrl">Image URL:</label>
        <input type="url" id="imageUrl" name="imageUrl" required><br><br>

        <button type="submit">Generate DOCX</button>
    </form>

    <script>
        document.getElementById('docForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const coordinates = document.getElementById('coordinates').value;
            const description = document.getElementById('description').value;
            const imageUrl = document.getElementById('imageUrl').value;

            const doc = new docx.Document();

            doc.addSection({
                children: [
                    new docx.Paragraph(`Coordinates: ${coordinates}`),
                    new docx.Paragraph(`Description: ${description}`),
                    new docx.Paragraph('Image:'),
                    await createImageParagraph(imageUrl),
                ],
            });

            docx.Packer.toBlob(doc).then(blob => {
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'document.docx';
                link.click();
            });
        });

        async function createImageParagraph(url) {
            const response = await fetch(url);
            const buffer = await response.arrayBuffer();
            const image = new docx.ImageRun({
                data: buffer,
                transformation: { width: 100, height: 100 }
            });

            return new docx.Paragraph({
                children: [image],
            });
        }
    </script>
</body>
</html>
